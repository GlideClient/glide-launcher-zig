name: Build

on: [push, pull_request]

jobs:
  build-linux:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: goto-bus-stop/setup-zig@v2
        with:
          version: 0.15.2
      - run: sudo apt-get update && sudo apt-get install -y --no-install-recommends libx11-dev libxrandr-dev libxcursor-dev libxi-dev libxinerama-dev libgl1-mesa-dev
      - run: zig build -Doptimize=ReleaseFast
      - uses: actions/upload-artifact@v4
        with:
          name: glide-launcher-linux
          path: zig-out/bin/glide_launcher_zig

  build-windows:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: goto-bus-stop/setup-zig@v2
        with:
          version: 0.15.2
      - run: sudo apt-get update && sudo apt-get install -y --no-install-recommends libx11-dev libxrandr-dev libxcursor-dev libxi-dev libxinerama-dev libgl1-mesa-dev
      - run: zig build -Dtarget=x86_64-windows -Doptimize=ReleaseFast
      - uses: actions/upload-artifact@v4
        with:
          name: glide-launcher-windows
          path: zig-out/bin/glide_launcher_zig.exe

  build-macos:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v4
      - uses: goto-bus-stop/setup-zig@v2
        with:
          version: 0.15.2
      - run: zig build -Doptimize=ReleaseFast
      - uses: actions/upload-artifact@v4
        with:
          name: glide-launcher-macos
          path: zig-out/bin/glide_launcher_zig
